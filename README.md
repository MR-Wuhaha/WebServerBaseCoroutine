基于腾讯协程库libco的Web服务器
==============

## 主要原理
1、同一个线程中采用协程的方式处理连接的数据，即多个连接在同一个线程中是以协程的方式运行的<br>
2、如果运行的线程数为1，当前的线程会负责新连接的建立以及处理新连接的数据<br>
3、如果运行的线程数大于1，则当前的线程仅作为创建连接的线程，将新建立的连接以协程的方式分配到其他的线程中<br>
4、采用EventFd的方式作为主线程通知其他线程新连接的fd，通过写入fd的信息传递新建立的fd，唤醒其他线程的EventFd运行的协程来处理<br>
5、因为EventFd并不是系统co_accept得到的fd，因此不再系统hook的范围内，所以需要设置为非阻塞并在阻塞时主动poll让出协程<br>
6、EventLoop线程在运行前需要先建立当前线程的协程Epoll信息，并运行创建连接的线程<br>
7、日志与线程池采用双缓冲队列实现写日志与线程任务的执行<br>
8、采用时间轮管理超时连接


## 代码使用方法
### 腾讯协程库
如果腾讯协程库还未编译，则按照以下的方式编译：<br>
cd libco/build<br>
make<br>
会生成一个协程动态链接库，作为后续项目链接使用

### 本项目代码
cd WebServerBaseCoroutine/<br>
mkdir build<br>
cd build<br>
cmake ..<br>
make<br>

### 代码运行
./WebServerBaseCoroutine (int)thread_num<br>
thread_num参数为线程的数量，不加该参数默认为1条线程，加上该参数则会运行thread_num条线程，其中主线程用于建立连接，其他线程处理连接的数据